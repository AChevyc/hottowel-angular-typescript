{"version":3,"sources":["client/app/blocks/router/router-helper.service.ts"],"names":["blocks","blocks.router","blocks.router.RouterHelper","blocks.router.RouterHelper.constructor","blocks.router.RouterHelper.handleRoutingErrors","blocks.router.RouterHelper.handleStateChanges"],"mappings":"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","file":"client/app/blocks/router/router-helper.service.js","sourceRoot":"/Users/john/_git/angular-typescript-hottowel-demo/","sourcesContent":["module blocks.router {\r\n    'use strict';\r\n\r\n    export interface IRouterHelper {\r\n        stateCounts: { errors: number; changes: number};\r\n    }\r\n\r\n    export class RouterHelper implements IRouterHelper {\r\n        static $inject: Array<string> = ['$location', '$rootScope', '$state', 'logger'];\r\n        constructor(private $location, private $rootScope, private $state, private logger) {\r\n            this.handleRoutingErrors();\r\n            this.handleStateChanges();\r\n        }\r\n\r\n        stateCounts = { errors: 0, changes: 0 };\r\n\r\n        private handlingStateChangeError: boolean = false;\r\n\r\n        private handleRoutingErrors() {\r\n            //TODO: must inject $state so we can kick off routing\r\n            // Route cancellation:\r\n            // On routing error, go to the dashboard.\r\n            // Provide an exit clause if it tries to do it twice.\r\n            this.$rootScope.$on('$stateChangeError',\r\n                (event, toState, toParams, fromState, fromParams, error) => {\r\n                    if (this.handlingStateChangeError) {\r\n                        return;\r\n                    }\r\n                    this.stateCounts.errors++;\r\n                    this.handlingStateChangeError = true;\r\n                    var destination = (toState &&\r\n                        (toState.title || toState.name || toState.loadedTemplateUrl)) ||\r\n                        'unknown target';\r\n                    var msg = 'Error routing to ' + destination + '. ' +\r\n                        (error.data || '') + '. <br/>' + (error.statusText || '') +\r\n                        ': ' + (error.status || '');\r\n                    this.logger.warning(msg, [toState]);\r\n                    this.$location.path('/');\r\n                }\r\n                );\r\n        }\r\n\r\n        private handleStateChanges() {\r\n            this.$rootScope.$on('$stateChangeSuccess',\r\n                (event, toState, toParams, fromState, fromParams) => {\r\n                    this.stateCounts.changes++;\r\n                    this.handlingStateChangeError = false;\r\n                    //var title = config.docTitle + ' ' + (toState.title || '');\r\n                    var title = (toState.title || '');\r\n                    this.$rootScope.title = title; // data bind to <title>\r\n                });\r\n        }\r\n    }\r\n\r\n    angular\r\n        .module('blocks.router')\r\n        .service('RouterHelper', RouterHelper);\r\n}"]}